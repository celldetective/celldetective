Table Explorer (Table UI)
=======================

.. _table_exploration:

The Table Explorer (internally ``TableUI``) is a powerful interface for interacting with your measurement data. It allows you to visualize data structure, perform calculations, generate plots, and aggregate track information.

Overview
--------

The Table UI provides a spreadsheet-like view of your data with extensive capabilities for data manipulation and visualization. It is accessible from various parts of the application where measurement tables are displayed.

Menu Actions
------------

The menu bar provides several categories of actions:

File
~~~~

- **Save as...** (``Ctrl+S``): Save the current table to a CSV file.
- **Save inplace...**: Save the table back to its original location (if applicable). Use this only if you created new measurements that you would like to keep with the data (e.g., a difference of times).
- **Plot...** (``Ctrl+P``): Open the plotting interface for 1D/2D data visualization.
- **Plot instantaneous...** (``Ctrl+I``): Toggle between static plots and interactive track signal plots.
- **Collapse tracks...** (``Ctrl+G``): Open the dialogue to aggregate track data (see `Track Collapsing`_).
- **Collapse pairs in neighborhood...**: (For pair tables) Aggregate interaction data based on defined neighborhoods.
- **Group by frames...** (``Ctrl+T``): Aggregate data by time frame to see population-level temporal trends.
- **Query...**: Filter the table using SQL-like queries.

  .. tip::
      The query syntax follows pandas' ``query()`` method.
      
      **Examples:**
      
      - Filter by value: ``area > 500``
      - Combine conditions: ``area > 500 and mean_intensity < 200``
      - Filter by category: ``cell_type == 'Tumor'``


Edit
~~~~

- **Delete...** (``Del``): Delete selected columns.
- **Rename...**: Rename the selected column.

Math
~~~~
Perfom mathematical operations on columns:

- **Calibrate...** (``Ctrl+C``): Apply a calibration factor to a column.
- **Merge states...**: Merge multiple classification/status columns.
- **Differentiate...** (``Ctrl+D``): Compute the derivative of a column (requires tracks).

  .. note::
     The derivative is computed track by track. The implementation allows you to choose a **window size** (integer number of frames) and a **mode** (``forward``, ``backward``, or ``bi``-directional) for the finite difference computation.
     
     See the tutorial :doc:`/how-to-guides/advanced/compute-derivative-measurement` for a step-by-step example.

- **Absolute value...**: Compute the absolute value of a column.
- **Log (decimal)...**: Compute the base-10 logarithm of a column.
- **Divide/Multiply/Add/Subtract...**: Perform arithmetic operations between two selected columns.

Plotting
--------

The Table UI offers versatile plotting capabilities. Select columns in the table and use **File > Plot...** (``Ctrl+P``) to visualize them.

1D Plotting
~~~~~~~~~~~
If one column is selected (or no specific column), the 1D plot interface opens. It supports:

- **Distributions**: Histogram, KDE plot, ECDF plot.
- **Categorical**: Countplot, Swarm plot, Violin plot, Strip plot, Box plot, Boxenplot.
- **Stats**: Option to compute KS test p-values and Cliff's Delta effect size.
- **Grouping**: Select X, Y, and Hue variables to group data.

2D Plotting
~~~~~~~~~~~
If two columns are selected, a scatter plot is automatically generated comparing the two variables.

Time Series / Track Signals
~~~~~~~~~~~~~~~~~~~~~~~~~~~
When viewing track data, you can visualize signals over time:

- **Plot instantaneous...** (``Ctrl+I``): Switches the plotting mode to show track signals when rows are selected, allowing you to see the temporal evolution of metrics for selected cells.

Track Collapsing
----------------

One of the most powerful features is the ability to aggregate data at the track level. This transforms your data from a **time-series format** (one row per timepoint) to a **track-based format** (one row per cell track). Use **File > Collapse tracks...** (``Ctrl+G``) to open the projection mode dialog.

Global Operation
~~~~~~~~~~~~~~~~
Collapse the entire track into a single value using an aggregation function.

- **Operations**: `mean`, `median`, `min`, `max`, `first`, `last`, `prod`, `sum`.
- **Example 1**: You want to know if a cell *ever* expressed a marker. Use **max** on the intensity column.
- **Example 2**: You want to correlate cell size with fate. Use **mean** on the ``area`` column to get the average size of the cell over its lifetime.

@ Event Time
~~~~~~~~~~~~
Extract measurement values at a specific event time. This is useful for synchronizing data around biological events.

- **Prerequisite**: Your table must contain event times (columns starting with ``t_`` or ``t0``), typically generated by the *Event Detection* or *Event Annotation* modules.
- **Example**: "What was the cell's nuclear circularity **at the moment of division**?". Select ``@ t0`` (or your specific event column). The resulting table will contain the value of ``circularity`` at the frame corresponding to that event for each cell.

Per Status
~~~~~~~~~~
Aggregate measurements independently for each cell state or status.

- **Prerequisite**: Your table must contain status or classification columns (starting with ``status_`` or ``group_``).
- **Example**: Compare protein localization during the cell cycle.
    - If you have a ``status_cell_cycle`` column (with values like G1, S, G2), selecting this option with **mean** will create separate columns for each phase (e.g., ``mean_intensity_G1``, ``mean_intensity_S``).
    - You can then easily plot these against each other to see stage-specific differences.

